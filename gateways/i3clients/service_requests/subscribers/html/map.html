<!DOCTYPE html>
<html>
  <head>
    <style>
       #map {
        height: 550px;
        width: 100%;
       }
    </style>
   
    <script src="map_arrays.js"></script>
    <script src="jquery-3.2.1.js"></script>

    <script type="text/javascript">

	var map;

	var hloc = homeless_locs();
	var gloc = graffiti_locs();
	var dloc = dead_animal_locs();
	var iloc = illegal_dumping_locs();
	var eloc = electronic_locs();
	var bloc = bulky_items_locs();
	var mloc = metal_locs();
	var wloc = water_waste_locs();
	var ssloc = s_streetlight_locs(); 
	var msloc = m_streetlight_locs();


	var showH;
	var showG;
	var showD;
	var showI;
	var showE;
	var showB;
	var showM;
	var showW;
	var showSS;
	var showMS;


	var pinIconH = 'http://www.googlemapsmarkers.com/v1/H/ADFF2F/';
 	var pinIconG = 'http://www.googlemapsmarkers.com/v1/G/009900/';
	var pinIconD = 'http://www.googlemapsmarkers.com/v1/D/ffff00/';
	var pinIconI = 'http://www.googlemapsmarkers.com/v1/I/0000ff/';
	var pinIconE = 'http://www.googlemapsmarkers.com/v1/E/ffa500/';
	var pinIconB = 'http://www.googlemapsmarkers.com/v1/B/ff69b4/';
	var pinIconM = 'http://www.googlemapsmarkers.com/v1/M/ee00ee/';
	var pinIconW = 'http://www.googlemapsmarkers.com/v1/W/87ceeb/';
	var pinIconSS = 'http://www.googlemapsmarkers.com/v1/SS/c0c0c0/';
	var pinIconMS = 'http://www.googlemapsmarkers.com/v1/MS/d2b48c/';
        
    var markersH = [];
	var markersG = [];
	var markersD;
	var markersI;
	var markersE;
	var markersB;
	var markersM;
	var markersW;
	var markersSS;
	var markersMS;
   

	function getChoice() {
	    var i = document.getElementById('showText').selectedIndex;

	    switch(i){
		case 0:
			document.getElementById("text").innerHTML = "";
			break;
		case 1:
			setText(hloc);
			break;
		case 2:
			setText(gloc);
			break;
		case 3:
			setText(dloc);
			break;
		case 4:
			setText(iloc);
			break;
		case 5:
			setText(eloc);
			break;
		case 6:
			setText(bloc);
			break;
		case 7:
			setText(mloc);
			break;
		case 8:
			setText(wloc);
			break;
		case 9:
			setText(ssloc);
			break;
		case 10:
			setText(ssloc);
			break;

	    }  
	}


	function setText(loc){

		var content = "";
		for(var i=0; i<loc.length; i++){
		    content +=
		    '<p><b>request type:  </b>' + loc[i].requesttype + '<br>' +  
		    '<b>address:  </b>' + loc[i].address + '<br>' +
		    '<b>police precinct:  </b>' + loc[i].policeprecinct + '<br>' +
		    '<b>createddate:  </b>' + loc[i].createddate + '<br>' +
		    '<b>action taken:  </b>' + loc[i].actiontaken + '</p>'
		}
	
		document.getElementById('text').innerHTML = content;
	}





    function initMap() {

        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 10,
          center: {lat: 34.0522, lng: -118.2437}
        });

        var trafficLayer = new google.maps.TrafficLayer();
            trafficLayer.setMap(map);

        showH = document.getElementById('dispH').checked;
        showG = document.getElementById('dispG').checked;
        showD = document.getElementById('dispD').checked;
        showI = document.getElementById('dispI').checked;
        showE = document.getElementById('dispE').checked;
        showB = document.getElementById('dispB').checked;
        showM = document.getElementById('dispM').checked;
        showW = document.getElementById('dispW').checked;
        showSS = document.getElementById('dispSS').checked;
        showMS = document.getElementById('dispMS').checked;



        function makeMarkers(loc, pinIcon,show){
          markers = []
          for (var i=0; i<loc.length; i++){
             markers.push(new google.maps.Marker({
                    position: new google.maps.LatLng(loc[i].lat, loc[i].lng),
                visible: show,
                icon: pinIcon,
                map: map
                    }));
          }
          return markers
        }

        function makeWindows(markers, loc){
            for (var i=0; i<loc.length; i++){
            contentString = '<div id="content">'+
                '<div id="bodyContent">'+
                '<p><b>request type:  </b>' + loc[i].requesttype + '<br>' +
            '<b>address:  </b>' + loc[i].address + '<br>' +
            '<b>police precinct:  </b>' + loc[i].policeprecinct + '<br>' +
            '<b>createddate:  </b>' + loc[i].createddate + '<br>' +
            '<b>action taken:  </b>' + loc[i].actiontaken +'</p>' +
                '</div>' + '</div>'

                infowindow = new google.maps.InfoWindow({content:contentString});

            google.maps.event.addListener(markers[i], 'click', (function (infowindow) {
                    return function () {
                        infowindow.open(map, this);
                        }
                    })(infowindow));
            }
        }

        markersH = makeMarkers(hloc,pinIconH,showH);
        makeWindows(markersH,hloc);

        markersG = makeMarkers(gloc,pinIconG,showG);
        makeWindows(markersG,gloc);

        markersD = makeMarkers(dloc,pinIconD,showD);
        makeWindows(markersD,dloc);

        markersI = makeMarkers(iloc,pinIconI,showI);
        makeWindows(markersI,iloc);

        markersE = makeMarkers(eloc,pinIconE,showE);
        makeWindows(markersE,eloc);

        markersB = makeMarkers(bloc,pinIconB,showB);
        makeWindows(markersB,bloc);

        markersM = makeMarkers(mloc,pinIconM,showM);
        makeWindows(markersM,mloc);

        markersW = makeMarkers(wloc,pinIconW,showW);
        makeWindows(markersW,wloc);

        markersSS = makeMarkers(ssloc,pinIconSS,showSS);
        makeWindows(markersSS,ssloc);

        markersMS = makeMarkers(msloc,pinIconMS,showMS);
        makeWindows(markersMS,msloc);
    }
        
    function showMarkers(){
        for(var i=0; i<markersH.length; i++){
            markers.setVisible(true);
        }   
    }
           
    </script>

  </head>
  <body>
    <h3>Service Requests in Los Angeles County</h3>
      <div style="width:80%;float:left">
        <label><input id="dispH" type="checkbox" onclick="showMarkers()" /><span>Homeless Encampment</span></label>
        <label><input id="dispG" type="checkbox" /><span>Graffiti Removal</span></label>
        <label><input id="dispD" type="checkbox" /><span>Dead Animal Removal</span></label>
        <label><input id="dispI" type="checkbox" /><span>Illegal Dumping Pickup</span></label>
        <label><input id="dispE" type="checkbox" /><span>Electronic Waste</span></label>
        <label><input id="dispB" type="checkbox" /><span>Bulky Items</span></label>
        <label><input id="dispM" type="checkbox" /><span>Metal/Household Appliances</span></label>
        <label><input id="dispW" type="checkbox" /><span>Report Water Waste</span></label>
        <label><input id="dispSS" type="checkbox" /><span>Single Streetlight Issue</span></label>
        <label><input id="dispMS" type="checkbox" /><span>Multiple Streetlight Issue</span></label>

        <div><button type="button" onclick="initMap();" >update map</button></div>
    
        <div id="map" ></div>
        
      </div>
    <div style="width:17%;float:right">
        <div>        
            <select id="showText" name="theText" onChange="getChoice()">
            <option selected="selected">Select Text</option>
            <option value="hloc" >Homeless Encampment</option>
            <option value="gloc" onSelect="enable();">Graffiti Removal</option>
            <option value="dloc" onSelect="enable();">Dead Animal Removal</option>
            <option value="iloc" onSelect="enable();">Illegal Dumping Pickup</option>
            <option value="eloc" onSelect="enable();">Electronic Waste</option>
            <option value="bloc" onSelect="enable();">Bulky Items</option>
            <option value="mloc" onSelect="enable();">Metal/Household Appliances</option>
            <option value="wloc" onSelect="enable();">Report Water Waste</option>
            <option value="ssloc"onSelect="enable();">Single Streetlight Issue</option>
            <option value="msloc" onSelect="enable();">Multiple Streetlight Issue</option>
            </select> 
        </div>
        <div id="text" style="overflow-y:scroll; height:500px; padding:10px 10px 10px 10px" ></div> 
    </div>

    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyALZgGws3IIr5O3LcWZTCD3W3IKa0l6YrI&callback=initMap">
    </script>
  </body>
</html>
